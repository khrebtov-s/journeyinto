{"version":3,"sources":["webpack:///./src/app/pages/teachers/public-teacher-profile/recordings/public-recordings.component.html","webpack:///./src/app/pages/teachers/public-teacher-profile/recordings/single-recording/public-single-recording.component.html","webpack:///./src/app/pages/teachers/public-teacher-profile/recordings/public-recordings.component.scss","webpack:///./src/app/pages/teachers/public-teacher-profile/recordings/public-recordings.component.ts","webpack:///./src/app/pages/teachers/public-teacher-profile/recordings/public-recordings.module.ts","webpack:///./src/app/pages/teachers/public-teacher-profile/recordings/single-recording/public-single-recording.component.scss","webpack:///./src/app/pages/teachers/public-teacher-profile/recordings/single-recording/public-single-recording.component.ts"],"names":[],"mappings":"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","file":"recordings-public-recordings-module.19170ca715a7ddaf03a6.js","sourcesContent":["module.exports = \"<div class=\\\"wrapper\\\">\\n    <ul class=\\\"teachers-recordings\\\">\\n        <li *ngFor=\\\"let recording of recordings\\\">\\n            <app-class-card \\n                [singleClass]=\\\"recording\\\"\\n                [teacher]=\\\"teacher\\\"></app-class-card>\\n        </li>\\n    </ul>\\n</div>\"","module.exports = \"<ng-container *ngIf=\\\"!accessDenied.status\\\">\\n    <app-class-recording \\n        *ngIf=\\\"recording\\\"\\n        [recording]=\\\"recording\\\"></app-class-recording>\\n</ng-container>\\n<ng-container *ngIf=\\\"accessDenied.status\\\">\\n    <section class=\\\"wrapper\\\">\\n        <p>Sorry, you can't access this recording.</p>\\n        \\n        <a *ngIf=\\\"accessDenied.reason.url\\\"\\n            mat-ripple\\n            class=\\\"btn access-denied-cta\\\"\\n            [routerLink]=\\\"accessDenied.reason.url\\\">{{accessDenied.reason.text}}</a>\\n        \\n        <button *ngIf=\\\"accessDenied.reason.classBought\\\"\\n            mat-ripple\\n            class=\\\"btn access-denied-cta\\\"\\n            (click)=\\\"buyClass(accessDenied.reason.classBought)\\\">\\n            {{accessDenied.reason.text}}\\n        </button>\\n    </section>\\n</ng-container>\"","module.exports = \".teachers-recordings {\\n  margin-top: 40px;\\n  padding: 0; }\\n\\nli:not(:last-child) {\\n  margin-bottom: 20px; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9raHJlYnRvdi9Qcm9qZWN0cy9qb3VybmV5aW50by1mcm9udGVuZC9zcmMvYXBwL3BhZ2VzL3RlYWNoZXJzL3B1YmxpYy10ZWFjaGVyLXByb2ZpbGUvcmVjb3JkaW5ncy9wdWJsaWMtcmVjb3JkaW5ncy5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFnQjtFQUNoQixVQUFVLEVBQUE7O0FBR2Q7RUFDSSxtQkFBbUIsRUFBQSIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL3RlYWNoZXJzL3B1YmxpYy10ZWFjaGVyLXByb2ZpbGUvcmVjb3JkaW5ncy9wdWJsaWMtcmVjb3JkaW5ncy5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi50ZWFjaGVycy1yZWNvcmRpbmdzIHtcbiAgICBtYXJnaW4tdG9wOiA0MHB4O1xuICAgIHBhZGRpbmc6IDA7XG59XG5cbmxpOm5vdCg6bGFzdC1jaGlsZCkge1xuICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XG59Il19 */\"","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Subscription, Observable } from 'rxjs';\nimport { select, Store } from '@ngrx/store';\nimport { selectTeachersObject } from '@src/app/store/modules/teachers/teachers.selectors';\nimport { filter } from 'rxjs/operators';\nimport { TeacherInterface } from '@src/app/interfaces/teachers';\nimport { RecordingInterface } from '@src/app/interfaces/recording';\nimport { RouteNames } from '@src/app/route-names';\nimport { Router } from '@angular/router';\nimport { SpinnerOverlayService } from '../../../../services';\nimport { IAppState } from '@src/app/store/app.reducers';\n\n@Component({\n    selector: 'app-public-recordings',\n    templateUrl: './public-recordings.component.html',\n    styleUrls: ['./public-recordings.component.scss']\n})\nexport class PublicRecordingsComponent implements OnInit, OnDestroy {\n    public subscriptions: Subscription[] = [];\n\n    public teacher$: Observable<any> = this.store.pipe(\n        select(selectTeachersObject),\n        filter(Boolean)\n    );\n    public teacher: TeacherInterface;\n    public recordings: RecordingInterface[];\n\n    constructor(\n        private store: Store<IAppState>,\n        private router: Router,\n        private spinnerOverlay: SpinnerOverlayService\n    ) {\n        // showoverlay\n    }\n\n    ngOnInit() {\n        // when someone lands on this page, direct them to the teacher profile instead!\n        this.subscriptions.push(\n            this.teacher$.subscribe(\n                (obj) => {\n                    const teacher = obj.currentTeacher;\n                    if (teacher) {\n                        this.router.navigate(['/', RouteNames.teachers, teacher.slug]);\n                    }\n                }\n            )\n        );\n    }\n\n    ngOnDestroy() {\n        this.subscriptions.forEach(subscription => subscription.unsubscribe());\n    }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule } from '@angular/router';\nimport { CommonModule } from '@angular/common';\nimport { FlexLayoutModule } from '@angular/flex-layout';\nimport { TeachersComponent } from '@src/app/pages/teachers/teachers.component';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MatRippleModule } from '@angular/material';\n\nimport { RouteNames } from '@src/app/route-names';\nimport { PublicRecordingsComponent } from './public-recordings.component';\nimport { PublicSingleRecordingComponent } from './single-recording/public-single-recording.component';\nimport { ClassCardModule } from '@src/app/components/class-card/class-card.module';\nimport { ClassRecordingModule } from '@src/app/components/class-recording/class-recording.module';\n\n@NgModule({\n    declarations: [\n        PublicRecordingsComponent,\n        PublicSingleRecordingComponent\n    ],\n    imports: [\n        CommonModule,\n        FlexLayoutModule,\n        FormsModule,\n        ReactiveFormsModule,\n        FlexLayoutModule,\n        MatRippleModule,\n        ClassCardModule,\n        ClassRecordingModule,\n        RouterModule.forChild([\n            {\n                path: '',\n                component: PublicRecordingsComponent,\n                data: {\n                    title: 'Teacher Classes',\n                    goBack: true\n                }\n            },\n            {\n                path: ':recordingSlug',\n                component: PublicSingleRecordingComponent,\n                data: {\n                    title: 'Listen and Flow',\n                    goBack: true\n                }\n            }\n        ])\n    ]\n})\nexport class PublicRecordingsModule { }\n","module.exports = \".wrapper {\\n  text-align: center;\\n  padding-top: 24px; }\\n\\n.access-denied-cta {\\n  margin-top: 40px; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9raHJlYnRvdi9Qcm9qZWN0cy9qb3VybmV5aW50by1mcm9udGVuZC9zcmMvYXBwL3BhZ2VzL3RlYWNoZXJzL3B1YmxpYy10ZWFjaGVyLXByb2ZpbGUvcmVjb3JkaW5ncy9zaW5nbGUtcmVjb3JkaW5nL3B1YmxpYy1zaW5nbGUtcmVjb3JkaW5nLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksa0JBQWtCO0VBQ2xCLGlCQUFpQixFQUFBOztBQUdyQjtFQUNJLGdCQUFnQixFQUFBIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvdGVhY2hlcnMvcHVibGljLXRlYWNoZXItcHJvZmlsZS9yZWNvcmRpbmdzL3NpbmdsZS1yZWNvcmRpbmcvcHVibGljLXNpbmdsZS1yZWNvcmRpbmcuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIud3JhcHBlciB7XG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgIHBhZGRpbmctdG9wOiAyNHB4O1xufVxuXG4uYWNjZXNzLWRlbmllZC1jdGEge1xuICAgIG1hcmdpbi10b3A6IDQwcHg7XG59Il19 */\"","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { Subscription, Observable } from 'rxjs';\nimport { IAppState } from '@src/app/store/app.reducers';\nimport { Store, select } from '@ngrx/store';\nimport { TeacherInterface } from '@src/app/interfaces/teachers';\nimport { filter, tap, take } from 'rxjs/operators';\nimport { selectTeachersObject } from '@src/app/store/modules/teachers/teachers.selectors';\nimport { Router, NavigationEnd, ActivatedRoute } from '@angular/router';\nimport { selectUserActive } from '@src/app/store/modules/user/user.selectors';\nimport { ViewStatuses } from '@src/app/store/modules/user/user.types';\nimport { RouteNames } from '@src/app/route-names';\nimport { AuthorizationService } from '@src/app/services';\nimport { SpinnerOverlayService } from '@src/app/services';\nimport { SetBackSharedAction } from '@src/app/store/modules/shared/shared.actions';\nimport { UtilsService } from '@src/app/services/utils.service';\n\n@Component({\n    selector: 'app-public-single-recording',\n    templateUrl: './public-single-recording.component.html',\n    styleUrls: ['./public-single-recording.component.scss']\n})\nexport class PublicSingleRecordingComponent implements OnInit, OnDestroy {\n    public subscriptions: Subscription[] = [];\n\n    public teacher$: Observable<any> = this.store.pipe(\n        select(selectTeachersObject),\n        filter(Boolean)\n    );\n    public user$: Observable<any> = this.store.pipe(\n        select(selectUserActive),\n        filter(Boolean),\n        take(1)\n    );\n    public teacher: TeacherInterface;\n    private recordingSlug = this.route.snapshot.paramMap.get('recordingSlug');\n    public recording;\n    public user;\n\n    private accessDeniedReasons = {\n        differentTeacher: {\n            text: 'View your profile.',\n            url: ['/', RouteNames.profile]\n        },\n        differentStudentTeacher: {\n            text: 'View your teacher\\'s profile.',\n            url: []\n        },\n        noPurchase: {\n            text: 'Purchase this class for £5',\n            classBought: null\n        },\n        noLoggedIn: {\n            text: 'Log in and try again',\n            url: ['/', RouteNames.login]\n        }\n    };\n    public accessDenied = {\n        status: false,\n        reason: null\n    };\n\n    public viewStatus = ViewStatuses;\n\n    constructor(\n        private store: Store<IAppState>,\n        private router: Router,\n        private route: ActivatedRoute,\n        private authservice: AuthorizationService,\n        private spinner: SpinnerOverlayService,\n        private utils: UtilsService\n    ) {\n        // showoverlay\n    }\n\n    ngOnInit() {\n        this.subscriptions.push(\n            this.user$.subscribe(\n                user => {\n                    this.user = user;\n                    this.checkRecordingAccess();\n                }\n            ),\n            this.teacher$.subscribe(\n                ({currentTeacher}) => {\n                    if (currentTeacher) {\n                        // hideoverlay\n                        const allClasses = [...currentTeacher.sample_classes, ...currentTeacher.classes];\n                        this.recording = allClasses.find(recording => {\n                            return recording.slug === this.recordingSlug;\n                        });\n\n                        if (!this.recording) {\n                            this.router.navigate(['/', RouteNames.notFound]);\n                        } else {\n                            this.store.dispatch(new SetBackSharedAction(['/', RouteNames.teachers, currentTeacher.slug]));\n\n                            // if it is a short class don't worry about permissions\n                            if (this.recording.is_fixed) {\n                                return;\n                            }\n\n                            // if it NOT a short class, let's check permissions....\n                            if (!this.authservice.isAuthenticated()) {\n                                this.accessDenied = {\n                                    status: true,\n                                    reason: this.accessDeniedReasons.noLoggedIn\n                                };\n                            } else {\n                                this.checkRecordingAccess();\n                            }\n                            this.spinner.hide();\n                        }\n                    }\n                }\n            )\n        );\n    }\n\n    ngOnDestroy() {\n        this.subscriptions.forEach(subscription => subscription.unsubscribe());\n    }\n\n    buyClass(classBought) {\n        this.router.navigate(['/', RouteNames.student, RouteNames.subscription], {\n            state: {\n                data: { classBought }\n            }\n        });\n    }\n\n    checkRecordingAccess() {\n        if (this.user && this.recording) {\n          // Access is denied if...\n          // 1) if the user is a teacher and the creatorslug of the recording is different from the slug of the teacher/..\n          if (\n            this.user.view_status === ViewStatuses.TEACHER &&\n            this.user.creator &&\n            this.user.creator.slug !== this.recording.creatorslug\n          ) {\n            this.accessDenied = {\n              status: true,\n              reason: this.accessDeniedReasons.differentTeacher\n            };\n          }\n\n          // 2) if the user is a student...\n          if (this.user.view_status === ViewStatuses.STUDENT) {\n            const studentTeacher = this.user.creators ? this.user.creators[0].creator : false;\n\n            // 2a) ...and the creatorslug of the recording is different from the slug of the teacher they are connected to\n            if (studentTeacher.slug !== this.recording.creatorslug) {\n              this.accessDenied = {\n                status: true,\n                reason: this.accessDeniedReasons.differentStudentTeacher\n              };\n\n              this.accessDeniedReasons.differentStudentTeacher.url = ['/', RouteNames.teachers, studentTeacher.slug];\n\n              // 2b) ... and the student is not subscribed to the teacher and they haven't bought the class\n            } else if (studentTeacher.subscribed.length === 0 && !this.recording.is_fixed) {\n              const studentRecording = studentTeacher.classes.find(singleClass => {\n                return singleClass.id === this.recording.id;\n              });\n\n              if (studentRecording && !studentRecording.is_bought) {\n                this.accessDenied = {\n                  status: true,\n                  reason: this.accessDeniedReasons.noPurchase\n                };\n\n                this.accessDeniedReasons.noPurchase.classBought = studentRecording;\n              }\n            }\n          }\n        }\n    }\n\n    log(text, ...args) {\n        this.utils.log(text, 'pink', 'blue', args);\n    }\n\n}\n"],"sourceRoot":""}